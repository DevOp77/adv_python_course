<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>

<head>
    <title>Entity Extractions by Publication</title>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>


    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- production version, optimized for size and speed -->
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script type="text/javascript">


        document.addEventListener('DOMContentLoaded', function () {

            var elem = document.querySelector('.sidenav');
            window.sideBarInstance = M.Sidenav.init(elem, { edge: 'right', preventScrolling: false });

            window.slideOut = new Vue({
                el: '#slide-out',
                data() {
                    return {
                        publication: '',
                        wordcounts: []
                    }
                },
                methods: {
                    open: function (publ) {
                        this.publication = publ;

                        fetch(`http://localhost:8000/words?pubs=${publ}`)
                            .then(resp => resp.json())
                            .then(json => this.wordcounts = json[publ])
                            .catch(err => console.log(err));

                        window.sideBarInstance.open();
                    },
                    getNext: function () {
                        let last = this.wordcounts[this.wordcounts.length - 1]
                        fetch(`http://localhost:8000/words?pubs=${this.publication}&word=${last.word}&count=${last.count}`)
                            .then(resp => resp.json())
                            .then(json => this.wordcounts = json[publ])
                            .catch(err => console.log(err));
                    }
                }
            })

            window.app = new Vue({
                el: '#app',
                data() {
                    return {
                        pubs: []
                    }
                },
                mounted() {
                    fetch('http://localhost:8000/pubs')
                        .then(resp => resp.json())
                        .then(json => this.pubs = json)
                        .catch(err => console.log(err));

                },
                methods: {
                    openSidebar: function (publ) {
                        window.slideOut.open(publ);
                    }
                }
            });


        });



    </script>



</head>

<body>
    <!-- Navbar goes here -->
    <nav>
        <div class="nav-wrapper">
            <a href="#" class="brand-logo">Cloud Academy</a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="comparison.html">Side-by-side Comparison</a></li>
            </ul>
        </div>
    </nav>

    <!-- Page Layout here -->
    <div id="app" class="row">

        <div class="col s9 details">
            <div class="row">

                <div v-for="pub in pubs" class="col s6">
                    <div class="card">
                        <div class="card-image">
                            <img v-bind:src="pub.img">
                            <a @click="openSidebar(pub.pub)"
                                class="preview-btn btn-floating halfway-fab waves-effect waves-light red"><i
                                    class="material-icons">preview</i></a>
                        </div>
                        <div class="card-content">
                            <p>
                                Publication: {{pub.pub}}
                                <br>
                                Articles: {{pub.count}}
                            </p>
                        </div>
                    </div>
                </div>

            </div>

        </div>





        <div class="col s3"></div>
    </div>


    <div class="sidenav">

        <ul id="slide-out" class="collection with-header">
            <li class="collection-header">
                <h4>{{publication}}</h4>
            </li>
            <li @click="getPrevious(publication)" class="waves-effect"><a href="#!"><i
                        class="material-icons">chevron_left</i></a>
            </li>

            <li @click="getNext(publication)" class="waves-effect"><a href="#!"><i
                        class="material-icons">chevron_right</i></a>
            </li>
            <li class="collection-item" v-for="(count, word) in wordcounts">
                <div>{{word}}<a href="#!" class="secondary-content">{{count}}</a></div>
            </li>
        </ul>


    </div>

</body>

</html>